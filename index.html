<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>OMNIFIT 5‑System Widget</title>
  <style>
    :root{
      /* OMNIFIT brand */
      --sage:#E6F0D8;            /* background base */
      --terra:#D95C4C;           /* accent */
      --ink:#0F172A;             /* near-black */
      --ink-70:#334155;          /* secondary text */
      --line:#7aa3ff22;          /* subtle border */
      --card:#ffffff;            /* card bg */
      --blue:#78A8FF;            /* light header number tint (from reference mock) */
    }
    html,body{height:100%;margin:0;font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";}
    body{background:var(--sage);display:flex;align-items:center;justify-content:center;padding:8px;overflow:hidden;}

    .widget{width:min(560px,100%);background:var(--card);border:2px solid #5A8AF3; border-radius:14px;box-shadow: 0 6px 20px rgba(16,24,40,.08);padding:18px;box-sizing:border-box;}

    .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .date-wrap{display:flex;align-items:center;justify-content:center;gap:14px;margin-bottom:14px}
    .icon-btn{width:44px;height:44px;border-radius:10px;border:1.5px solid #1112;display:grid;place-items:center;background:#fff;cursor:pointer;}
    .icon-btn:disabled{opacity:.4;cursor:not-allowed}
    .bigdate{font-weight:800;font-size:56px;letter-spacing:2px;color:#9FC1FF}

    .tabs{display:flex;gap:12px;justify-content:center;margin:8px 0 16px;flex-wrap:wrap;}
    .tab{padding:10px 18px;border-radius:10px;border:2px solid #111;cursor:pointer;background:#000;color:#fff;font-weight:800;letter-spacing:.3px}
    .tab.active{background:#5A8AF3;border-color:#2E5FF0}

    .subhead{display:flex;align-items:center;gap:10px;color:#9FC1FF;font-size:24px;margin:6px 0 8px}

    .card{background:#fff;border:1.5px solid var(--line);border-radius:12px;padding:18px}
    .title{font-size:38px;line-height:1.05;margin:6px 0 8px;color:#000;font-weight:900}
    .label{color:#475569;font-size:18px;margin:6px 0}
    .content{font-size:22px;color:#111;}

    .foot{display:flex;justify-content:space-between;align-items:center;margin-top:14px}
    .badge{font-size:12px;background:#F8FAFF;border:1px solid #DCE7FF;color:#2E5FF0;padding:6px 10px;border-radius:999px}

    /* responsive */
    @media (max-width:420px){
      .bigdate{font-size:40px}
      .tab{padding:8px 12px}
      .title{font-size:28px}
      .content{font-size:18px}
    }
  </style>
</head>
<body>
<div class="widget" id="omnifit-widget" aria-live="polite">
  <div class="date-wrap">
    <button id="prevBtn" class="icon-btn" title="Previous day" aria-label="Previous day">&#8592;</button>
    <div class="bigdate" id="dayTitle">OMNIFIT Daily — Day 560</div>
    <button id="nextBtn" class="icon-btn" title="Next day" aria-label="Next day">&#8594;</button>
  </div>
    <button id="nextBtn" class="icon-btn" title="Next day" aria-label="Next day">&#8594;</button>
  </div>

  <div class="tabs" role="tablist">
    <button class="tab" role="tab" data-tab="physical">PHYSICAL</button>
    <button class="tab" role="tab" data-tab="neurological">NEUROLOGICAL</button>
    <button class="tab active" role="tab" data-tab="cognitive">COGNITIVE</button>
    <button class="tab" role="tab" data-tab="emotional">EMOTIONAL</button>
    <button class="tab" role="tab" data-tab="lifestyle">LIFESTYLE</button>
  </div>

  <div class="subhead" id="subhead">
    <span id="weekday">TUESDAY</span>
    <span id="dateTiny">000000</span>
  </div>

  <div class="card">
    <div class="title" id="title">OMNIFIT DAILY</div>
    <div class="label">Today:</div>
    <div class="content" id="content">Loading…</div>
    <div class="foot"><span class="badge" id="badge">Cognitive</span></div>
  </div>
</div>

<script>
/* ==========================
   CONFIG
   ========================== */
// Replace with your RAW GitHub Gist URL (the JSON file). Example placeholder:
const GIST_URL = "https://gist.githubusercontent.com/your-user/your-gist-id/raw/omnifit_14days.json";
// Day label between arrows:
const DAY_LABEL = "OMNIFIT Daily — Day 560";

// If the fetch fails, we fall back to the inline SAMPLE_DATA below.

/* ==========================
   DATA SHAPE (example)
   ==========================
{
  "days": [
    {"date":"2025-11-25","physical":"Move 10 minutes without your phone.",
      "neurological":"Balance on one leg, 60s each.",
      "cognitive":"3‑minute nose‑breathing with full focus.",
      "emotional":"Cold shower 30s, stay calm.",
      "lifestyle":"Drink ½ liter of water before coffee."},
    … more days …
  ]
}
*/

// --- Fallback sample (feel free to edit or delete once your gist is live) ---
const SAMPLE_DATA = {
  days: [
    {date: "2025-11-25", physical:"30 slow squats, breathe through nose.", neurological:"6-sec down push-ups, 5 reps.", cognitive:"Name one sensation per minute during a walk.", emotional:"Write one line: what triggered me today?", lifestyle:"Plan sleep 30 min earlier tonight."},
    {date: "2025-11-26", physical:"8-min EMOM: 5 air squats + 20s plank.", neurological:"Stand up/sit down slowly x6 (no hands).", cognitive:"3-min timer: single-task breathing only.", emotional:"2x1 min box-breath (4-4-4-4).", lifestyle:"Add 20g protein to breakfast."},
    {date: "2025-11-27", physical:"Walk 1 km at easy pace.", neurological:"Eyes-closed single‑leg balance, 45s/side.", cognitive:"Before training: set 1 clear intention.", emotional:"Message someone: ‘thank you for…’.", lifestyle:"One colorful plant per plate."}
  ]
};

/* ==========================
   WIDGET LOGIC
   ========================== */
const state = {
  data: SAMPLE_DATA, // will be replaced after fetch
  idx: 0,
  system: 'cognitive'
};

const $ = (s)=>document.querySelector(s);
const $$ = (s)=>document.querySelectorAll(s);
const dayTitleEl = document.getElementById('dayTitle');
const weekdayEl = $('#weekday');
const dateTiny = $('#dateTiny');
const titleEl = $('#title');
const contentEl = $('#content');
const badgeEl = $('#badge');
const statusEl = $('#status');

function fmtDateISO(d){
  const yyyy=d.getFullYear();
  const mm=String(d.getMonth()+1).padStart(2,'0');
  const dd=String(d.getDate()).padStart(2,'0');
  return `${yyyy}-${mm}-${dd}`;
}
function toCompact(iso){return iso.replaceAll('-','');}
function weekdayName(iso){
  const dt = new Date(iso+'T00:00:00');
  return dt.toLocaleDateString(undefined,{weekday:'long'}).toUpperCase();
}
function capital(s){return s.charAt(0).toUpperCase()+s.slice(1);}

function findTodayIndex(days){
  const todayISO = fmtDateISO(new Date());
  let idx = days.findIndex(d=>d.date===todayISO);
  if(idx<0) idx = 0; // fallback first entry
  return idx;
}

function render(){
  const days = state.data.days || [];
  if(!days.length){
    titleEl.textContent = 'No Data Loaded';
    contentEl.textContent = 'Add at least one day to your JSON.';
    return;
  }
  const cur = days[state.idx];
  const iso = cur.date;
  dayTitleEl.textContent = DAY_LABEL;
  weekdayEl.textContent = weekdayName(iso);
  dateTiny.textContent = toCompact(iso);

  // Title: map system → headline
  // Edit display names here if you want (e.g., Move → Motion)
  const titles = {
    physical: 'Move',
    neurological: 'Control',
    cognitive: 'Focus',
    emotional: 'Regulate',
    lifestyle: 'Integrate'
  };
  titleEl.textContent = titles[state.system];
  contentEl.textContent = (cur[state.system]||'No entry for this system.');
  badgeEl.textContent = capital(state.system);

  // nav button states
  $('#prevBtn').disabled = (state.idx<=0);
  $('#nextBtn').disabled = (state.idx>=days.length-1);

  statusEl.textContent = '';
}

function bind(){
  // Tabs
  $$('.tab').forEach(btn=>{
    btn.addEventListener('click',()=>{
      $$('.tab').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      state.system = btn.dataset.tab;
      render();
    })
  });
  // Nav
  $('#prevBtn').addEventListener('click',()=>{ if(state.idx>0){state.idx--; render();} });
  $('#nextBtn').addEventListener('click',()=>{ const max=(state.data.days||[]).length-1; if(state.idx<max){state.idx++; render();} });
}

async function load(){
  try{
    const res = await fetch(GIST_URL,{cache:'no-store'});
    if(!res.ok) throw new Error('HTTP '+res.status);
    const json = await res.json();
    if(Array.isArray(json)){
      state.data = {days:json}; // allow raw array
    }else{
      state.data = json;
    }
    // sort by date
    state.data.days.sort((a,b)=>a.date.localeCompare(b.date));
    state.idx = findTodayIndex(state.data.days);
    
  }catch(e){
    console.warn('Using fallback data:', e);
    state.data = SAMPLE_DATA;
    state.idx = findTodayIndex(state.data.days);
    
  }
  render();
}

bind();
load();
</script>
</body>
</html>

